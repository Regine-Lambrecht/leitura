<!DOCTYPE html>
<html lang="pt-BR">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Aprendendo a leitura</title>
Â  Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
Â  Â  <style>
Â  Â  Â  Â  /* Estilos CSS (style.css incorporÃ©) */
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --cor-principal: #3498db; /* BLEU */
Â  Â  Â  Â  Â  Â  --cor-fundo: #ecf0f1;
Â  Â  Â  Â  Â  Â  --cor-sucesso: #2ecc71; /* VERT (SuccÃ¨s/Bravo) */
Â  Â  Â  Â  Â  Â  --cor-erreur: #e74c3c;
Â  Â  Â  Â  Â  Â  --cor-voltar: #3499db; /* BLEU para Voltar */
Â  Â  Â  Â  Â  Â  --cor-reset: #e74c3c;
Â  Â  Â  Â  Â  Â  --tamanho-letra: 24px;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Times New Roman', Times, serif;
Â  Â  Â  Â  Â  Â  background-color: var(--cor-fundo);
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  /* NEW: Base font size for mobile (0.9em) */
Â  Â  Â  Â  Â  Â  font-size: 0.9em; 
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  /* NEW: Media Query for Desktop (>= 600px screens) */
Â  Â  Â  Â  @media (min-width: 600px) {
Â  Â  Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  Â  Â  /* Increase base font size for desktop (1.0em) */
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 1.0em; 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }


Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  background: #fff;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  }

Â  Â  Â  Â  h1, h2, h3 {
Â  Â  Â  Â  Â  Â  font-family: 'Times New Roman', Times, serif;
Â  Â  Â  Â  Â  Â  color: var(--cor-principal);
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* SeÃ§Ã£o de PontuaÃ§Ã£o et Messages */
Â  Â  Â  Â  #score-container {
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  padding: 15px; /* Increased padding */
Â  Â  Â  Â  Â  Â  border: none;Â 
Â  Â  Â  Â  Â  Â  background: #f9f9f9;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  display: flex; /* Flex layout for image and text */
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  /* GLOBAL TEXT TRANSFORMATION & SIZE INCREASE */
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #pedro-image {
Â  Â  Â  Â  Â  Â  /* INCREASED SIZE TO 150x150px */
Â  Â  Â  Â  Â  Â  width: 150px;
Â  Â  Â  Â  Â  Â  height: 150px;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  object-fit: cover;
Â  Â  Â  Â  }

Â  Â  Â  Â  #score-text-content {
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  Â  Â  flex-grow: 1;
Â  Â  Â  Â  }

Â  Â  Â  Â  #progresso-msg {
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: var(--cor-sucesso);
Â  Â  Â  Â  Â  Â  margin-top: 5px;
Â  Â  Â  Â  Â  Â  font-size: 1.1em; /* Make message slightly bigger */
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Boutons de Niveau */
Â  Â  Â  Â  .nivel-btn {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  margin: 10px 0;
Â  Â  Â  Â  Â  Â  font-size: 1.2em;
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  Â  Â  background-color: var(--cor-principal);
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  Â  Â  Â  font-family: 'Times New Roman', Times, serif;
Â  Â  Â  Â  }

Â  Â  Â  Â  .nivel-btn span {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* NEW: Completed Level Color (Green) */
Â  Â  Â  Â  .nivel-btn.completed {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-sucesso);
Â  Â  Â  Â  Â  Â  cursor: default;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nivel-btn.completed:hover:not(:disabled) {
Â  Â  Â  Â  Â  Â  background-color: #27ae60; /* Darker green on hover */
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Voltar est BLEU */
Â  Â  Â  Â  .nivel-btn.voltar-btn {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-voltar);
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .nivel-btn.voltar-btn:hover {
Â  Â  Â  Â  Â  Â  background-color: #2980b9;
Â  Â  Â  Â  }

Â  Â  Â  Â  .nivel-btn:hover:not(:disabled) {
Â  Â  Â  Â  Â  Â  background-color: #2980b9;
Â  Â  Â  Â  }

Â  Â  Â  Â  .nivel-btn:disabled {
Â  Â  Â  Â  Â  Â  background-color: #bdc3c7;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  Â  Â  color: #7f8c8d;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* **CORREÃ‡ÃƒO CRÃTICA**: Garante que o verde prevaleÃ§a sobre o cinza do :disabled */
Â  Â  Â  Â  .nivel-btn.completed:disabled {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-sucesso);
Â  Â  Â  Â  Â  Â  color: white; /* Garante que o texto fique branco */
Â  Â  Â  Â  }


Â  Â  Â  Â  /* Conteneur pour les icÃ´nes Ã  direita do termo */
Â  Â  Â  Â  .icon-container {
Â  Â  Â  Â  Â  Â  margin-left: 10px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .icon-container i {
Â  Â  Â  Â  Â  Â  margin-right: 2px;
Â  Â  Â  Â  Â  Â  font-size: 1.5em;
Â  Â  Â  Â  }

Â  Â  Â  Â  .contador-progresso {
Â  Â  Â  Â  Â  Â  font-size: 0.8em;
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  Â  Â  padding: 2px 8px;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Bouton RecomeÃ§ar (on home screen) */
Â  Â  Â  Â  /* REMOVED #btn-reset-level STYLES */

Â  Â  Â  Â  #btn-reset-global {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-reset);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  margin: 20px auto 0 auto; /* Centered margin */
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  font-family: 'Times New Roman', Times, serif;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  display: flex;Â 
Â  Â  Â  Â  Â  Â  width: 70%; /* Reduced width */
Â  Â  Â  Â  Â  Â  max-width: 300px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }


Â  Â  Â  Â  /* Visibilidade des Telas */
Â  Â  Â  Â  .tela-jogo {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  padding-top: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* NÃ­vel 1: Letras (Damier) */
Â  Â  Â  Â  #letras-grid {
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(3, 1fr);
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .letra-quadro {
Â  Â  Â  Â  Â  Â  height: 80px;
Â  Â  Â  Â  Â  Â  background-color: #f1c40f;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  font-size: var(--tamanho-letra);
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s, transform 0.1s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .letra-quadro.selecionada {
Â  Â  Â  Â  Â  Â  background-color: #e67e22;
Â  Â  Â  Â  Â  Â  transform: scale(0.98);
Â  Â  Â  Â  }

Â  Â  Â  Â  .letra-quadro.correta {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-sucesso);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-cancelar {
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  background-color: var(--cor-erreur);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* NÃ­vel 2: Anagramas */
Â  Â  Â  Â  #palavra-alvo-container {
Â  Â  Â  Â  Â  Â  /* Target word - always visible in CAPS */
Â  Â  Â  Â  Â  Â  font-size: 2.5em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: var(--cor-principal);
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  letter-spacing: 5px;
Â  Â  Â  Â  Â  Â  min-height: 50px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #selecao-atual {
Â  Â  Â  Â  Â  Â  /* Space to show selected letters */
Â  Â  Â  Â  Â  Â  font-size: 2.5em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  min-height: 50px;
Â  Â  Â  Â  Â  Â  border-bottom: 2px solid #ccc;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  padding-bottom: 10px;
Â  Â  Â  Â  Â  Â  letter-spacing: 5px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  #anagrama-grid {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .anagrama-letra {
Â  Â  Â  Â  Â  Â  width: 45px;
Â  Â  Â  Â  Â  Â  height: 45px;
Â  Â  Â  Â  Â  Â  background-color: #f1c40f;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  font-size: 1.5em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s, opacity 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .anagrama-letra.invisivel {
Â  Â  Â  Â  Â  Â  opacity: 0.3;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* NÃ­vel 3 (SÃ­labas) */
Â  Â  Â  Â  #opcoes-silabas {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-around;
Â  Â  Â  Â  Â  Â  gap: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #silaba-container {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-principal);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 15px 30px;
Â  Â  Â  Â  Â  Â  margin: 20px auto 30px auto;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  font-size: 3em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* NÃ­vel 4 (IdentificaÃ§Ã£o) */
Â  Â  Â  Â  #identificacao-alvo {
Â  Â  Â  Â  Â  Â  font-size: 2.5em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: var(--cor-principal);
Â  Â  Â  Â  Â  Â  margin-bottom: 25px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* CORREÃ‡ÃƒO: Faz os botÃµes do NÃ­vel 4 ficarem lado a lado (NEXT TO THE OTHER) */
Â  Â  Â  Â  #opcoes-identificacao {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-around;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Styles pour les boutons de rÃ©ponse dans les niveaux 3, 4 et 5 */
Â  Â  Â  Â  .opcao-btn, .btn-verdadeiro-falso {
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  margin: 10px 0;
Â  Â  Â  Â  Â  Â  font-size: 1.2em;
Â  Â  Â  Â  Â  Â  border: 2px solid var(--cor-principal);
Â  Â  Â  Â  Â  Â  background-color: white;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  Â  Â  Â  font-family: 'Times New Roman', Times, serif;
Â  Â  Â  Â  Â  Â  display: block; /* Default to block, adjust below if inside flex container */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #opcoes-silabas .opcao-btn {
Â  Â  Â  Â  Â  Â  flex-grow: 1;
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  width: auto;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Ajuste para botÃµes do NÃ­vel 4 e 5 ficarem inline-block dentro do flex container */
Â  Â  Â  Â  #opcoes-identificacao .opcao-btn, #opcoes-palavras .opcao-btn {
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  flex-grow: 1; /* Permite que cresÃ§am para preencher o espaÃ§o */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* ContÃªiner para NÃ­vel 5 (Ãudio) - TambÃ©m usando flex para alinhamento horizontal */
Â  Â  Â  Â  #opcoes-palavras {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-around;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .opcao-btn:hover, .btn-verdadeiro-falso:hover {
Â  Â  Â  Â  Â  Â  background-color: #eee;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* NÃ­vel 5 (Ãudio) */
Â  Â  Â  Â  .btn-audio {
Â  Â  Â  Â  Â  Â  width: auto;
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  background-color: var(--cor-principal);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  margin: 10px auto 25px auto;
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  font-family: 'Times New Roman', Times, serif;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-audio i {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  font-size: 1.4em;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Message Bravo et Overlay */
Â  Â  Â  Â  /* REMOVED #mensagem-bravo STYLES */

Â  Â  Â  Â  #overlay {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  padding: 25px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
Â  Â  Â  Â  Â  Â  z-index: 1001;
Â  Â  Â  Â  Â  Â  width: 80%;
Â  Â  Â  Â  Â  Â  max-width: 350px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Modal de ConfirmaÃ§Ã£o */
Â  Â  Â  Â  #modal-confirmacao {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  padding: 25px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
Â  Â  Â  Â  Â  Â  z-index: 1001;
Â  Â  Â  Â  Â  Â  width: 80%;
Â  Â  Â  Â  Â  Â  max-width: 350px;
Â  Â  Â  Â  }

Â  Â  Â  Â  #modal-confirmacao p {
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .botoes-modal {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .botoes-modal button {
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  width: 50%;
Â  Â  Â  Â  Â  Â  font-family: 'Times New Roman', Times, serif;
Â  Â  Â  Â  }

Â  Â  Â  Â  #btn-sim-reset-global {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-reset);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  #btn-nao {
Â  Â  Â  Â  Â  Â  background-color: var(--cor-voltar);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }


Â  Â  Â  Â  @keyframes fadeIn {
Â  Â  Â  Â  Â  Â  from { opacity: 0; }
Â  Â  Â  Â  Â  Â  to { opacity: 1; }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

<div id="overlay" style="display: none;"></div>

<div id="modal-confirmacao" style="display: none;">
Â  Â  <p id="modal-reset-text">VocÃª vai perder todos os pontos do NÃ­vel 3 (SÃ­labas). Quer mesmo recomeÃ§ar?</p>
Â  Â  <div class="botoes-modal">
Â  Â  Â  Â  <button id="btn-sim-reset-global" onclick="confirmaRecomeco()">Sim</button>
Â  Â  Â  Â  <button id="btn-nao" onclick="cancelaRecomeco()">NÃ£o</button>
Â  Â  </div>
</div>

<div class="container">
Â  Â  <div id="tela-home" class="tela-jogo" style="display: block;">
Â  Â  Â  Â  <h1>Oi Pedro ! Vamos estudar !</h1>

Â  Â  Â  Â  <div id="score-container">
Â  Â  Â  Â  Â  Â  <img id="pedro-image" src="https://regine-lambrecht.github.io/leitura/Pedro.png" alt="Pedro Icon">
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="score-text-content">
Â  Â  Â  Â  Â  Â  Â  Â  <p>CONQUISTAS: <span id="score-valor">34</span> / 64 PONTOS!</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p id="progresso-msg">MUITO BEM! SUA LEITURA ESTÃ VOANDO ALTO! ğŸˆ</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button class="nivel-btn completed" id="btn-nivel-1" onclick="iniciarNivel(1)" disabled="">
Â  Â  Â  Â  Â  Â  <span class="content-left-group">Letras (pares) <span class="icon-container"><i class="fa-solid fa-trophy"></i></span></span>
Â  Â  Â  Â  Â  Â  <span class="contador-progresso" id="count-n1">(4/4)</span>
Â  Â  Â  Â  </button>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <button class="nivel-btn completed" id="btn-nivel-2" onclick="iniciarNivel(2)" disabled="">
Â  Â  Â  Â  Â  Â  <span class="content-left-group">Letras de palavras <span class="icon-container"><i class="fa-solid fa-trophy"></i><i class="fa-solid fa-trophy"></i></span></span>
Â  Â  Â  Â  Â  Â  <span class="contador-progresso" id="count-n2">(10/10)</span>
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <button class="nivel-btn completed" id="btn-nivel-3" onclick="iniciarNivel(3)" disabled="">
Â  Â  Â  Â  Â  Â  <span class="content-left-group">SÃ­labas <span class="icon-container"><i class="fa-solid fa-eye"></i></span></span>
Â  Â  Â  Â  Â  Â  <span class="contador-progresso" id="count-n3">(20/20)</span>
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <button class="nivel-btn" id="btn-nivel-4" onclick="iniciarNivel(4)">
Â  Â  Â  Â  Â  Â  <span class="content-left-group">IdentificaÃ§Ã£o <span class="icon-container"><i class="fa-solid fa-medal"></i></span></span>
Â  Â  Â  Â  Â  Â  <span class="contador-progresso" id="count-n4">(0/20)</span>
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <button class="nivel-btn" id="btn-nivel-5" onclick="iniciarNivel(5)" disabled="">
Â  Â  Â  Â  Â  Â  <span class="content-left-group">Palavras (Ã¡udio) <span class="icon-container"><i class="fa-solid fa-graduation-cap"></i></span></span>
Â  Â  Â  Â  Â  Â  <span class="contador-progresso" id="count-n5">(0/10)</span>
Â  Â  Â  Â  </button>


Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn-reset-global" onclick="mostrarModalRecomeco('global')" style="display: flex;">
Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-sync-alt"></i> RECOMEÃ‡AR TUDO DE ZERO
Â  Â  Â  Â  </button>
Â  Â  </div>

Â  Â  <div id="tela-nivel-1" class="tela-jogo" style="display: none;">
Â  Â  Â  Â  <h2>Letras (Pares)</h2>
Â  Â  Â  Â  <p>Encontre os 6 pares (MaiÃºscula e minÃºscula).</p>
Â  Â  Â  Â  <div id="letras-grid"></div>
Â  Â  Â  Â  <button class="btn-cancelar" onclick="cancelarSelecaoNivel1()">Cancelar</button>
Â  Â  Â  Â  <button class="nivel-btn voltar-btn" onclick="mostrarTela('home')">Voltar</button>
Â  Â  </div>

Â  Â  <div id="tela-nivel-2" class="tela-jogo" style="display: none;">
Â  Â  Â  Â  <h2>Letras de Palavras</h2>
Â  Â  Â  Â  <p>Monte a palavra em MAIÃšSCULAS na ordem correta.</p>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="palavra-alvo-container"></div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="selecao-atual"></div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="anagrama-grid"></div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <button class="btn-cancelar" id="btn-cancelar-anagrama" onclick="cancelarSelecaoNivel2()">Cancelar</button>
Â  Â  Â  Â  <button class="nivel-btn voltar-btn" onclick="mostrarTela('home')">Voltar</button>
Â  Â  </div>

Â  Â  <div id="tela-nivel-3" class="tela-jogo" style="display: none;">
Â  Â  Â  Â  <h2>SÃ­labas</h2>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <h3>Qual Ã© a silaba em minusculas?</h3>

Â  Â  Â  Â  <div id="silaba-container">
Â  Â  Â  Â  Â  Â  <span id="silaba-maiuscula">PE</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="opcoes-silabas"><button class="opcao-btn">pm</button><button class="opcao-btn">le</button><button class="opcao-btn">pe</button></div>
Â  Â  Â  Â  <button class="nivel-btn voltar-btn" onclick="mostrarTela('home')">Voltar</button>
Â  Â  </div>

Â  Â  <div id="tela-nivel-4" class="tela-jogo" style="display: none;">
Â  Â  Â  Â  <h2>IdentificaÃ§Ã£o de Palavras</h2>
Â  Â  Â  Â  <p>Encontre a palavra em minÃºsculas que corresponde Ã  palavra MAIÃšSCULA.</p>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="identificacao-alvo">LÃPIS</div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="opcoes-identificacao"><button class="opcao-btn">lÃ¡pis</button><button class="opcao-btn">peixe</button><button class="opcao-btn">urubu</button></div>

Â  Â  Â  Â  <button class="nivel-btn voltar-btn" onclick="mostrarTela('home')">Voltar</button>
Â  Â  </div>

Â  Â  <div id="tela-nivel-5" class="tela-jogo" style="display: none;">
Â  Â  Â  Â  <h2>Palavras (Ãudio)</h2>
Â  Â  Â  Â  <p>Escute a palavra e a encontre entre les options.</p>
Â  Â  Â  Â  <button class="btn-audio" onclick="falarPalavraAtual()"><i class="fa-solid fa-volume-up"></i></button>
Â  Â  Â  Â  <div id="opcoes-palavras"></div>
Â  Â  Â  Â  <button class="nivel-btn voltar-btn" onclick="mostrarTela('home')">Voltar</button>
Â  Â  </div>

Â  Â  </div>

<script>
Â  Â  // ConfiguraÃ§Ã£o das vozes TTS
Â  Â  const synth = window.speechSynthesis;
Â  Â  let brazilVoice = null;

Â  Â  function setupVoice() {
Â  Â  Â  Â  const voices = synth.getVoices();
Â  Â  Â  Â  brazilVoice = voices.find(voice => voice.lang === 'pt-BR') || voices[0];
Â  Â  }

Â  Â  if (synth.onvoiceschanged !== undefined) {
Â  Â  Â  Â  synth.onvoiceschanged = setupVoice;
Â  Â  } else {
Â  Â  Â  Â  setupVoice();
Â  Â  }

Â  Â  function falarTexto(texto) {
Â  Â  Â  Â  if (synth.speaking) {
Â  Â  Â  Â  Â  Â  synth.cancel();
Â  Â  Â  Â  }
Â  Â  Â  Â  const utterance = new SpeechSynthesisUtterance(texto);
Â  Â  Â  Â  utterance.lang = 'pt-BR';
Â  Â  Â  Â  utterance.rate = 0.8;
Â  Â  Â  Â  if (brazilVoice) {
Â  Â  Â  Â  Â  Â  utterance.voice = brazilVoice;
Â  Â  Â  Â  }
Â  Â  Â  Â  synth.speak(utterance);
Â  Â  }

Â  Â  // --- DADOS DU JEU (PALAVRAS E DEFINIÃ‡Ã•ES SIMPLIFICADAS) ---

Â  Â  const DADOS_LETRAS = [
Â  Â  Â  Â  ['A', 'a', 'E', 'e', 'I', 'i', 'O', 'o', 'U', 'u', 'Y', 'y'],
Â  Â  Â  Â  ['B', 'b', 'D', 'd', 'P', 'p', 'Q', 'q', 'R', 'r', 'V', 'v'],
Â  Â  Â  Â  ['C', 'c', 'F', 'f', 'G', 'g', 'H', 'h', 'J', 'j', 'T', 't'],
Â  Â  Â  Â  ['K', 'k', 'L', 'l', 'M', 'm', 'N', 'n', 'S', 's', 'X', 'x']
Â  Â  ];

Â  Â  // Final list of 60 words for all levels
Â  Â  let PALAVRAS_BASE = [
Â  Â  Â  Â  "Professor", "Jabuti", "Galinha", "Diploma", "Chiclete", "Peixe", "Quatro", "Foguete", "Barata", "Quadro",
Â  Â  Â  Â  "Abelha", "Aranha", "Arara", "Baleia", "Banana", "Bolacha", "Boliche", "Brasil", "Cabide", "Cabine",
Â  Â  Â  Â  "Cachorro", "Caneta", "Casada", "ChapÃ©u", "Chave", "Chupeta", "Chuva", "Cobra", "Coelho", "Cofre",
Â  Â  Â  Â  "DomingÃ£o", "Festejar", "Golfinho", "Invejar", "LÃ¡bio", "LÃ¡pis", "LeÃ£o", "Letra", "Livro", "MaÃ§Ã£",
Â  Â  Â  Â  "Macaco", "Navio", "OnÃ§a", "Peito", "Peteca", "Planejar", "Planilha", "Porco", "Porta", "Prato",
Â  Â  Â  Â  "Sacada", "Salada", "Sapato", "Sorriso", "Sorvete", "Tapete", "Vaca", "Telhado", "Tomada", "Urubu"
Â  Â  ];
Â  Â  let PALAVRAS = PALAVRAS_BASE.map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase());

Â  Â  // --- HARDCODED SYLLABLE LIST FOR LEVEL 3 (29 Total) ---
Â  Â  const SILABAS_ALVO = [
Â  Â  Â  Â  'a', 'be', 'lha', 'ra', 'nha', 'ba', 'lei', 'bo', 'la', 'cha',Â 
Â  Â  Â  Â  'li', 'che', 'bra', 'sil', 'ca', 'bi', 'de', 'ne', 'ta', 'sa',Â 
Â  Â  Â  Â  've', 'chu', 'pe', 'co', 'bra', 'e', 'lho', 'fre', 'pÃ¡u'Â 
Â  Â  ];

Â  Â Â 
Â  Â  function getSilabas(palavra) {
Â  Â  Â  Â  // This function is still needed for Level 4 and 5 distractors (for word size comparison)

Â  Â  Â  Â  let processedPalavra = palavra.toLowerCase();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 1. Split double consonants (RR, SS, etc.)
Â  Â  Â  Â  processedPalavra = processedPalavra.replace(/([r|s|c|p|t|b|d|f|g|k|m|n|v|x|z])\1/g, '$1-$1');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 2. Separate consonant clusters (VC-CV pattern)
Â  Â  Â  Â  processedPalavra = processedPalavra.replace(/([aeiouyÃ£ÃµÃ©ÃªÃ¡Ã­Ã³Ãº])([bdfghjklmnpqrstvwxyzÃ§])([bcdfghjklmnpqrstvwxyzÃ§])([aeiouyÃ£ÃµÃ©ÃªÃ¡Ã­Ã³Ãº])/gi, '$1$2-$3$4');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 3. Separate consonant that must break between vowels (V-CV rule)
Â  Â  Â  Â  processedPalavra = processedPalavra.replace(/([aeiouyÃ£ÃµÃ©ÃªÃ¡Ã­Ã³Ãº])([bcdfghjklmnpqrstvwxyzÃ§])([aeiouyÃ£ÃµÃ©ÃªÃ¡Ã­Ã³Ãº])/gi, '$1-$2$3');Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 4. Handle common consonant blends (TR, BR, PL, etc.) - keep them together
Â  Â  Â  Â  processedPalavra = processedPalavra.replace(/([bcdfghjklmnpqrstvwxyzÃ§])([l|r])/g, '$1$2');Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 5. Handle QU and GU
Â  Â  Â  Â  processedPalavra = processedPalavra.replace(/([qg]u)([aeiou])/g, '$1$2');Â 

Â  Â  Â  Â  let silabas = processedPalavra.split('-');
Â  Â  Â  Â Â 
Â  Â  Â  Â  silabas = silabas.map(s => s.trim()).filter(s => s.length > 0);
Â  Â  Â  Â Â 
Â  Â  Â  Â  return silabas;
Â  Â  }
Â  Â Â 
Â  Â  function shuffleArray(array) {
Â  Â  Â  Â  for (let i = array.length - 1; i > 0; i--) {
Â  Â  Â  Â  Â  Â  const j = Math.floor(Math.random() * (i + 1));
Â  Â  Â  Â  Â  Â  [array[i], array[j]] = [array[j], array[i]];
Â  Â  Â  Â  }
Â  Â  Â  Â  return array;
Â  Â  }
Â  Â Â 
Â  Â  function generateSimilarWords(correctWord, allWords) {
Â  Â  Â  Â  const correctLower = correctWord.toLowerCase();
Â  Â  Â  Â  const correctSyllabeCount = getSilabas(correctWord).length;

Â  Â  Â  Â  let candidates = allWords.filter(w => w.toLowerCase() !== correctLower).map(w => ({
Â  Â  Â  Â  Â  Â  word: w,
Â  Â  Â  Â  Â  Â  syllableCount: getSilabas(w).length
Â  Â  Â  Â  }));

Â  Â  Â  Â  candidates.sort((a, b) =>
Â  Â  Â  Â  Â  Â  Math.abs(a.syllableCount - correctSyllabeCount) - Math.abs(b.syllableCount - correctSyllabeCount)
Â  Â  Â  Â  );

Â  Â  Â  Â  const distractors = [];

Â  Â  Â  Â  while (distractors.length < 2 && candidates.length > 0) {
Â  Â  Â  Â  Â  Â  const index = Math.floor(Math.random() * candidates.length);
Â  Â  Â  Â  Â  Â  const candidate = candidates[index].word;

Â  Â  Â  Â  Â  Â  if (!distractors.includes(candidate)) {
Â  Â  Â  Â  Â  Â  Â  Â  distractors.push(candidate);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  candidates.splice(index, 1);
Â  Â  Â  Â  }

Â  Â  Â  Â  while (distractors.length < 2) {
Â  Â  Â  Â  Â  Â  Â distractors.push(correctWord.length > 3 ? correctWord.substring(0, correctWord.length-1) + 'o' : 'palavra');
Â  Â  Â  Â  }

Â  Â  Â  Â  return distractors.slice(0, 2);
Â  Â  }

Â  Â  // NEW FIXED TOTALS
Â  Â  const MAX_N1_COMPLETIONS = DADOS_LETRAS.length; // 4
Â  Â  const MAX_N2_COMPLETIONS = 10; // Anagramas (Words 1-10)
Â  Â  const MAX_N3_COMPLETIONS = 20; // SÃ­labas (Goal is 20 completed words)
Â  Â  const MAX_N4_COMPLETIONS = 20; // NEW: Identification (Words 31-50)
Â  Â  const MAX_N5_COMPLETIONS = 10; // Palavras Ãudio (Words 51-60)

Â  Â  function calcularTotalMaximo() {
Â  Â  Â  Â  // 4 + 10 + 20 + 20 + 10 = 64
Â  Â  Â  Â  return MAX_N1_COMPLETIONS + MAX_N2_COMPLETIONS + MAX_N3_COMPLETIONS + MAX_N4_COMPLETIONS + MAX_N5_COMPLETIONS;
Â  Â  }

Â  Â  // --- Variables d'Ã‰tat Global ---

Â  Â  const INITIAL_GAME_STATE = {
Â  Â  Â  Â  scoreGlobal: 0,
Â  Â  Â  Â  progressoNivel1: [0, 0, 0, 0],Â 
Â  Â  Â  Â  damierAtual: 0,
Â  Â  Â  Â  selecaoN1: [],
Â  Â  Â  Â Â 
Â  Â  Â  Â  progressoNivel2: 0,Â 
Â  Â  Â  Â  palavraAtualN2: null,
Â  Â  Â  Â  selecaoN2: [],Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  progressoNivel3: 0,Â 
Â  Â  Â  Â  syllabesCompletasPorPalavra: {}, // Tracks solved syllables (Key: syllable, Value: 1 if solved)
Â  Â  Â  Â Â 
Â  Â  Â  Â  progressoN4: 0, // NEW: Identification
Â  Â  Â  Â  palavrasCompletasN4: {},Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  progressoN5: 0,Â 
Â  Â  Â  Â  palavrasCompletasN5: {},Â 
Â  Â  };

Â  Â  let estadoJogo = {...INITIAL_GAME_STATE};
Â  Â  let nivelSendoResetado = null;Â 

Â  Â  let palavraAtual = '';Â 
Â  Â  let silabaAnteriorN3 = null;Â 
Â  Â  let palavraAnteriorN5 = null;Â 

Â  Â  // --- FUNÃ‡Ã•ES DE UTILIDADE ET PERSISTENCE ---

Â  Â  function carregarEstado() {
Â  Â  Â  Â  const estadoSalvo = localStorage.getItem('aprendendoAleitura');
Â  Â  Â  Â  if (estadoSalvo) {
Â  Â  Â  Â  Â  Â  estadoJogo = JSON.parse(estadoSalvo);
Â  Â  Â  Â  Â  Â  // Handle legacy state: Initialize new trackers if missing
Â  Â  Â  Â  Â  Â  if (!estadoJogo.palavrasCompletasN4) estadoJogo.palavrasCompletasN4 = {};
Â  Â  Â  Â  Â  Â  if (!estadoJogo.palavrasCompletasN5) estadoJogo.palavrasCompletasN5 = {};
Â  Â  Â  Â  Â  Â  if (!estadoJogo.syllabesCompletasPorPalavra) estadoJogo.syllabesCompletasPorPalavra = {};
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  estadoJogo = {...INITIAL_GAME_STATE};
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function salvarEstado() {
Â  Â  Â  Â  localStorage.setItem('aprendendoAleitura', JSON.stringify(estadoJogo));
Â  Â  }

Â  Â  /* MODAL AND RESET LOGIC */

Â  Â  function mostrarModalRecomeco(tipoReset) {
Â  Â  Â  Â  const modalText = document.getElementById('modal-reset-text');
Â  Â  Â  Â Â 
Â  Â  Â  Â  nivelSendoResetado = tipoReset; // Armazena 'global'
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (tipoReset === 'global') {
Â  Â  Â  Â  Â  Â  modalText.textContent = "VocÃª vai perder TODOS os pontos e todo o progresso. Quer mesmo recomeÃ§ar de zero?";
Â  Â  Â  Â  } 
Â  Â  Â  Â  // NÃ£o precisamos de lÃ³gica 'else' pois o reset de nÃ­vel foi removido.

Â  Â  Â  Â  document.getElementById('overlay').style.display = 'block';
Â  Â  Â  Â  document.getElementById('modal-confirmacao').style.display = 'block';
Â  Â  }

Â  Â  function cancelaRecomeco() {
Â  Â  Â  Â  document.getElementById('overlay').style.display = 'none';
Â  Â  Â  Â  document.getElementById('modal-confirmacao').style.display = 'none';
Â  Â  Â  Â  nivelSendoResetado = null;
Â  Â  }

Â  Â  // REMOVED: getHighestIncompleteLevel()
Â  Â  // REMOVED: resetarNivelAlvo(nivelAlvo)

Â  Â  // --- FUNÃ‡ÃƒO: Recalcula o score global somando todos os progressos ---
Â  Â  function recalcularScoreGlobal() {
Â  Â  Â  Â  const n1Score = estadoJogo.progressoNivel1.filter(c => c >= 2).length;
Â  Â  Â  Â  const n2Score = estadoJogo.progressoNivel2;
Â  Â  Â  Â  const n3Score = estadoJogo.progressoNivel3;
Â  Â  Â  Â  const n4Score = estadoJogo.progressoN4;
Â  Â  Â  Â  const n5Score = estadoJogo.progressoN5;
Â  Â  Â  Â Â 
Â  Â  Â  Â  estadoJogo.scoreGlobal = n1Score + n2Score + n3Score + n4Score + n5Score;
Â  Â  Â  Â  console.log(`[SCORE] Score Global recalculado: ${estadoJogo.scoreGlobal}`);
Â  Â  }
Â  Â  // --- FIM FUNÃ‡Ã•ES DE RESET/RECALCULO ---

Â  Â  function confirmaRecomeco() {
Â  Â  Â  Â  // Como sÃ³ temos reset global, simplificamos a funÃ§Ã£o.
Â  Â  Â  Â  console.log(`[CONFIRM] ConfirmaÃ§Ã£o de recomeÃ§o: Global`);
Â  Â  Â  Â  cancelaRecomeco();
Â  Â  Â  Â Â 
Â  Â  Â  Â  estadoJogo = {...INITIAL_GAME_STATE};
Â  Â  Â  Â  localStorage.removeItem('aprendendoAleitura');
Â  Â  Â  Â  
Â  Â  Â  Â  atualizarInterfaceHome();
Â  Â  Â  Â Â 
Â  Â  Â  Â  console.log('[INIT] Voltando para a Home apÃ³s reset global.');
Â  Â  Â  Â  mostrarTela('home');
Â  Â  }


Â  Â  function mostrarTela(nivelId) {
Â  Â  Â  Â  document.querySelectorAll('.tela-jogo').forEach(tela => tela.style.display = 'none');
Â  Â  Â  Â  const targetElement = document.getElementById(`tela-${nivelId}`);
Â  Â  Â  Â  if (targetElement) {
Â  Â  Â  Â  Â  Â  Â targetElement.style.display = 'block';
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â console.error(`Elemento com ID 'tela-${nivelId}' nÃ£o encontrado.`);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Update home page buttons visibility logic
Â  Â  Â  Â  document.getElementById('btn-reset-global').style.display = 'none';
Â  Â  Â  Â  // REMOVED: document.getElementById('btn-reset-level').style.display = 'none';
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (nivelId === 'home') {
Â  Â  Â  Â  Â  Â  document.getElementById('btn-reset-global').style.display = 'flex';
Â  Â  Â  Â  Â  Â  // REMOVED: document.getElementById('btn-reset-level').style.display = 'flex';
Â  Â  Â  Â  Â  Â  atualizarInterfaceHome();
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // Replaced exibirMensagemBravo with a direct callback function
Â  Â  function onGameSuccess(callback) {
Â  Â  Â  Â  // Simulates success logic without a Bravo message
Â  Â  Â  Â  if (callback) callback();
Â  Â  }

Â  Â  // --- LÃ“GICA DU SCORE ET PROGRESSÃƒO ---

Â  Â  function atualizarInterfaceHome() {
Â  Â  Â  Â  if (PALAVRAS.length === 0) {
Â  Â  Â  Â  Â  Â  Â  document.querySelector('.container').innerHTML =
Â  Â  Â  Â  Â  Â  Â  Â  "<h1>Erro de Carregamento</h1><p>NÃ£o foi possÃ­vel carregar as palavras. O jogo nÃ£o pode iniciar.</p>";
Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Recalcula o score global sempre que a interface Ã© atualizada, garantindo consistÃªncia.
Â  Â  Â  Â  recalcularScoreGlobal();

Â  Â  Â  Â  document.getElementById('score-valor').textContent = estadoJogo.scoreGlobal;
Â  Â  Â  Â  verificarMensagemProgresso(estadoJogo.scoreGlobal);
Â  Â  Â  Â  atualizarBotoesNivel();
Â  Â  Â  Â  salvarEstado();
Â  Â  }

Â  Â  function adicionarPonto() {
Â  Â  Â  Â  // A pontuaÃ§Ã£o global agora Ã© atualizada APENAS via recalcularScoreGlobal.
Â  Â  Â  Â  atualizarInterfaceHome();Â 
Â  Â  }

Â  Â  function atualizarBotoesNivel() {
Â  Â  Â  Â  const damierComplet = estadoJogo.progressoNivel1.filter(c => c >= 2).length;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const btnN1 = document.getElementById('btn-nivel-1');
Â  Â  Â  Â  const btnN2 = document.getElementById('btn-nivel-2');
Â  Â  Â  Â  const btnN3 = document.getElementById('btn-nivel-3');
Â  Â  Â  Â  const btnN4 = document.getElementById('btn-nivel-4');
Â  Â  Â  Â  const btnN5 = document.getElementById('btn-nivel-5');

Â  Â  Â  Â  // --- NIVEAU 1 (Letras) ---
Â  Â  Â  Â  const n1Completed = damierComplet === MAX_N1_COMPLETIONS;
Â  Â  Â  Â  document.getElementById('count-n1').textContent = `(${damierComplet}/${MAX_N1_COMPLETIONS})`;
Â  Â  Â  Â  btnN1.disabled = n1Completed;
Â  Â  Â  Â  if (n1Completed) btnN1.classList.add('completed'); else btnN1.classList.remove('completed');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- NIVEAU 2 (Anagramas) ---
Â  Â  Â  Â  const n2Completed = estadoJogo.progressoNivel2 >= MAX_N2_COMPLETIONS;
Â  Â  Â  Â  btnN2.disabled = !n1Completed || n2Completed;
Â  Â  Â  Â  document.getElementById('count-n2').textContent = `(${estadoJogo.progressoNivel2}/${MAX_N2_COMPLETIONS})`;
Â  Â  Â  Â  if (n2Completed) btnN2.classList.add('completed'); else btnN2.classList.remove('completed');

Â  Â  Â  Â  // --- NIVEAU 3 (SÃ­labas) ---
Â  Â  Â  Â  const n3Completed = estadoJogo.progressoNivel3 >= MAX_N3_COMPLETIONS;
Â  Â  Â  Â  btnN3.disabled = !n2Completed || n3Completed;
Â  Â  Â  Â  btnN3.querySelector('.contador-progresso').textContent = `(${Math.min(estadoJogo.progressoNivel3, MAX_N3_COMPLETIONS)}/${MAX_N3_COMPLETIONS})`;
Â  Â  Â  Â  if (n3Completed) btnN3.classList.add('completed'); else btnN3.classList.remove('completed');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- NIVEAU 4 (IdentificaÃ§Ã£o) ---
Â  Â  Â  Â  const n4Completed = estadoJogo.progressoN4 >= MAX_N4_COMPLETIONS;
Â  Â  Â  Â  btnN4.disabled = !n3Completed || n4Completed;
Â  Â  Â  Â  btnN4.querySelector('.contador-progresso').textContent = `(${Math.min(estadoJogo.progressoN4, MAX_N4_COMPLETIONS)}/${MAX_N4_COMPLETIONS})`;
Â  Â  Â  Â  if (n4Completed) btnN4.classList.add('completed'); else btnN4.classList.remove('completed');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- NIVEAU 5 (Palavras Ãudio) ---
Â  Â  Â  Â  const n5Completed = estadoJogo.progressoN5 >= MAX_N5_COMPLETIONS;
Â  Â  Â  Â  btnN5.disabled = !n4Completed || n5Completed;
Â  Â  Â  Â  btnN5.querySelector('.contador-progresso').textContent = `(${Math.min(estadoJogo.progressoN5, MAX_N5_COMPLETIONS)}/${MAX_N5_COMPLETIONS})`;
Â  Â  Â  Â  if (n5Completed) btnN5.classList.add('completed'); else btnN5.classList.remove('completed');
Â  Â  }


Â  Â  function verificarMensagemProgresso(score) {
Â  Â  Â  Â  const totalMaximo = calcularTotalMaximo();
Â  Â  Â  Â  const ratio = score / totalMaximo;
Â  Â  Â  Â  let message = "";

Â  Â  Â  Â  if (ratio >= 0.9) {
Â  Â  Â  Â  Â  Â  message = "VocÃª Ã© um mestre da leitura! Woohoo! ğŸ¥³";
Â  Â  Â  Â  } else if (ratio >= 0.7) {
Â  Â  Â  Â  Â  Â  message = "VocÃª estÃ¡ arrasando! Continue assim, CampeÃ£o! ğŸš€";
Â  Â  Â  Â  } else if (ratio >= 0.5) {
Â  Â  Â  Â  Â  Â  message = "Muito bem! Sua leitura estÃ¡ voando alto! ğŸˆ";
Â  Â  Â  Â  } else if (ratio >= 0.3) {
Â  Â  Â  Â  Â  Â  message = "Opa! Estamos no caminho certo! Vamos lÃ¡! ğŸ‘";
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  message = "Continue praticando! VocÃª vai pegar o jeito! ğŸ’ª";
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('progresso-msg').textContent = message.toUpperCase();
Â  Â  }

Â  Â  // --- NÃVEL 1: LETRAS (DAMIER) ---

Â  Â  function iniciarNivel(nivel) {
Â  Â  Â  Â  if (PALAVRAS.length === 0) {
Â  Â  Â  Â  Â  Â  Â  document.querySelector('.container').innerHTML =
Â  Â  Â  Â  Â  Â  Â  Â  "<h1>Erro</h1><p>NÃ£o foi possÃ­vel iniciar o nÃ­vel. O jogo nÃ£o carregou as palavras.</p>";
Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Sequential check (verificaÃ§Ã£o de nÃ­veis anteriores)
Â  Â  Â  Â  if (nivel > 1) {
Â  Â  Â  Â  Â  Â  const nivelAnterior = nivel - 1;
Â  Â  Â  Â  Â  Â  const progressos = [
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoNivel1.filter(c => c >= 2).length,Â 
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoNivel2,Â 
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoNivel3,Â 
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoN4,Â 
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoN5
Â  Â  Â  Â  Â  Â  ];
Â  Â  Â  Â  Â  Â  const maximos = [MAX_N1_COMPLETIONS, MAX_N2_COMPLETIONS, MAX_N3_COMPLETIONS, MAX_N4_COMPLETIONS, MAX_N5_COMPLETIONS];

Â  Â  Â  Â  Â  Â  if (progressos[nivelAnterior - 1] < maximos[nivelAnterior - 1]) {
Â  Â  Â  Â  Â  Â  Â  Â  // Se o nÃ­vel anterior ainda nÃ£o estiver completo, impede a entrada.
Â  Â  Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Troca a tela e inicia o nÃ­vel especÃ­fico
Â  Â  Â  Â  mostrarTela(`nivel-${nivel}`);
Â  Â  Â  Â  switch (nivel) {
Â  Â  Â  Â  Â  Â  case 1: iniciarNivel1(); break;
Â  Â  Â  Â  Â  Â  case 2: iniciarNivel2(); break;Â 
Â  Â  Â  Â  Â  Â  case 3: iniciarNivel3(); break;Â 
Â  Â  Â  Â  Â  Â  case 4: iniciarNivel4(); break;Â 
Â  Â  Â  Â  Â  Â  case 5: iniciarNivel5(); break;Â 
Â  Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  // NÃVEL 1 LOGIC
Â  Â  function iniciarNivel1() {
Â  Â  Â  Â  paresCorretosN1 = 0;
Â  Â  Â  Â  estadoJogo.selecaoN1 = [];

Â  Â  Â  Â  if (estadoJogo.progressoNivel1.filter(c => c >= 2).length === DADOS_LETRAS.length) {
Â  Â  Â  Â  Â  Â  mostrarTela('home'); return;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  let indexToLoad = estadoJogo.damierAtual % DADOS_LETRAS.length;
Â  Â  Â  Â Â 
Â  Â  Â  Â  let startCheck = indexToLoad;
Â  Â  Â  Â  while (estadoJogo.progressoNivel1[indexToLoad] >= 2) {
Â  Â  Â  Â  Â  Â  indexToLoad = (indexToLoad + 1) % DADOS_LETRAS.length;
Â  Â  Â  Â  Â  Â  if (indexToLoad === startCheck) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  mostrarTela('home'); return;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  estadoJogo.damierAtual = indexToLoad;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const damier = DADOS_LETRAS[estadoJogo.damierAtual];
Â  Â  Â  Â  const melange = [...damier].sort(() => Math.random() - 0.5);

Â  Â  Â  Â  const grid = document.getElementById('letras-grid');
Â  Â  Â  Â  grid.innerHTML = '';

Â  Â  Â  Â  melange.forEach(letra => {
Â  Â  Â  Â  Â  Â  const caseElement = document.createElement('div');
Â  Â  Â  Â  Â  Â  caseElement.textContent = letra;
Â  Â  Â  Â  Â  Â  caseElement.className = 'letra-quadro';
Â  Â  Â  Â  Â  Â  caseElement.dataset.letra = letra;
Â  Â  Â  Â  Â  Â  caseElement.onclick = () => selecionarLetra(caseElement);
Â  Â  Â  Â  Â  Â  grid.appendChild(caseElement);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function selecionarLetra(element) {
Â  Â  Â  Â  if (element.classList.contains('correta') || estadoJogo.selecaoN1.length >= 2) return;

Â  Â  Â  Â  if (estadoJogo.selecaoN1.includes(element)) return;

Â  Â  Â  Â  element.classList.add('selecionada');
Â  Â  Â  Â  estadoJogo.selecaoN1.push(element);

Â  Â  Â  Â  if (estadoJogo.selecaoN1.length === 2) {
Â  Â  Â  Â  Â  Â  verificarPares();
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function cancelarSelecaoNivel1() {
Â  Â  Â  Â  if (estadoJogo.selecaoN1.length >= 1) {
Â  Â  Â  Â  Â  Â  const lastElement = estadoJogo.selecaoN1.pop();
Â  Â  Â  Â  Â  Â  if (lastElement) {
Â  Â  Â  Â  Â  Â  Â  Â  lastElement.classList.remove('selecionada');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function verificarPares() {
Â  Â  Â  Â  const [elem1, elem2] = estadoJogo.selecaoN1;
Â  Â  Â  Â  const l1 = elem1.dataset.letra;
Â  Â  Â  Â  const l2 = elem2.dataset.letra;
Â  Â  Â  Â  const isPair = (l1.toLowerCase() === l2.toLowerCase()) && (l1 !== l2);

Â  Â  Â  Â  if (isPair) {
Â  Â  Â  Â  Â  Â  paresCorretosN1++;

Â  Â  Â  Â  Â  Â  elem1.classList.add('correta');
Â  Â  Â  Â  Â  Â  elem2.classList.add('correta');
Â  Â  Â  Â  Â  Â  elem1.classList.remove('selecionada');
Â  Â  Â  Â  Â  Â  elem2.classList.remove('selecionada');

Â  Â  Â  Â  Â  Â  if (paresCorretosN1 === 6) {
Â  Â  Â  Â  Â  Â  Â  Â  sucessoNivel1();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  elem1.classList.remove('selecionada');
Â  Â  Â  Â  Â  Â  Â  Â  elem2.classList.remove('selecionada');
Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  }
Â  Â  Â  Â  estadoJogo.selecaoN1 = [];
Â  Â  Â  Â  salvarEstado();
Â  Â  }

Â  Â  function sucessoNivel1() {
Â  Â  Â  Â  const currentCount = estadoJogo.progressoNivel1[estadoJogo.damierAtual];
Â  Â  Â  Â  const currentDamierIndex = estadoJogo.damierAtual;

Â  Â  Â  Â  estadoJogo.progressoNivel1[currentDamierIndex]++;
Â  Â  Â  Â  const didJustCompleteTwice = (currentCount === 1) && (estadoJogo.progressoNivel1[currentDamierIndex] === 2);
Â  Â  Â  Â Â 
Â  Â  Â  Â  estadoJogo.damierAtual = (currentDamierIndex + 1) % DADOS_LETRAS.length;

Â  Â  Â  Â  if (estadoJogo.progressoNivel1.filter(c => c >= 2).length === DADOS_LETRAS.length) {
Â  Â  Â  Â  Â  Â  onGameSuccess(() => mostrarTela('home'));Â 
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  iniciarNivel1();
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  salvarEstado();
Â  Â  Â  Â  atualizarInterfaceHome();Â 
Â  Â  }

Â  Â  // --- NÃVEL 2: LETRAS DE PALAVRAS (ANAGRAMAS) ---

Â  Â  const PALAVRAS_N2 = PALAVRAS.slice(0, MAX_N2_COMPLETIONS);Â 

Â  Â  function iniciarNivel2() {
Â  Â  Â  Â  if (estadoJogo.progressoNivel2 >= MAX_N2_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  const wordIndex = estadoJogo.progressoNivel2 % MAX_N2_COMPLETIONS;Â 
Â  Â  Â  Â  const targetWord = PALAVRAS_N2[wordIndex];
Â  Â  Â  Â Â 
Â  Â  Â  Â  estadoJogo.palavraAtualN2 = targetWord;
Â  Â  Â  Â  estadoJogo.selecaoN2 = [];

Â  Â  Â  Â  // 1. Set STATIC target word
Â  Â  Â  Â  document.getElementById('palavra-alvo-container').textContent = targetWord.toUpperCase();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 2. Clear selected letters container
Â  Â  Â  Â  document.getElementById('selecao-atual').textContent = '';

Â  Â  Â  Â  // 3. Prepare anagram grid
Â  Â  Â  Â  const letters = targetWord.toLowerCase().split('');
Â  Â  Â  Â  const shuffledLetters = shuffleArray(letters);

Â  Â  Â  Â  const grid = document.getElementById('anagrama-grid');
Â  Â  Â  Â  grid.innerHTML = '';
Â  Â  Â  Â Â 
Â  Â  Â  Â  shuffledLetters.forEach((letter, index) => {
Â  Â  Â  Â  Â  Â  const letterElement = document.createElement('div');
Â  Â  Â  Â  Â  Â  letterElement.textContent = letter;
Â  Â  Â  Â  Â  Â  letterElement.className = 'anagrama-letra';
Â  Â  Â  Â  Â  Â  letterElement.dataset.originalIndex = index;
Â  Â  Â  Â  Â  Â  letterElement.onclick = () => selecionarLetraNova(letterElement, letter);
Â  Â  Â  Â  Â  Â  grid.appendChild(letterElement);
Â  Â  Â  Â  });

Â  Â  Â  Â  document.getElementById('btn-cancelar-anagrama').disabled = true;
Â  Â  }
Â  Â Â 
Â  Â  function selecionarLetraNova(element, letter) {
Â  Â  Â  Â  const selectedContainer = document.getElementById('selecao-atual');
Â  Â  Â  Â  const targetWord = estadoJogo.palavraAtualN2.toLowerCase();
Â  Â  Â  Â  const targetLength = targetWord.length;

Â  Â  Â  Â  if (estadoJogo.selecaoN2.length >= targetLength) return;

Â  Â  Â  Â  estadoJogo.selecaoN2.push({ element: element, letter: letter });
Â  Â  Â  Â  element.classList.add('invisivel');Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Update selection display
Â  Â  Â  Â  const selectedWordSoFar = estadoJogo.selecaoN2.map(item => item.letter.toUpperCase()).join('');
Â  Â  Â  Â  selectedContainer.textContent = selectedWordSoFar;
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('btn-cancelar-anagrama').disabled = false;

Â  Â  Â  Â  if (estadoJogo.selecaoN2.length === targetLength) {
Â  Â  Â  Â  Â  Â  document.getElementById('btn-cancelar-anagrama').disabled = true; // Disable cancel when full
Â  Â  Â  Â  Â  Â  verificarAnagrama();
Â  Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function cancelarSelecaoNivel2() {
Â  Â  Â  Â  const lastSelection = estadoJogo.selecaoN2.pop();
Â  Â  Â  Â  if (lastSelection) {
Â  Â  Â  Â  Â  Â  lastSelection.element.classList.remove('invisivel');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const selectedContainer = document.getElementById('selecao-atual');
Â  Â  Â  Â  Â  Â  const selectedWordSoFar = estadoJogo.selecaoN2.map(item => item.letter.toUpperCase()).join('');
Â  Â  Â  Â  Â  Â  selectedContainer.textContent = selectedWordSoFar;

Â  Â  Â  Â  Â  Â  if (estadoJogo.selecaoN2.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('btn-cancelar-anagrama').disabled = true;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function verificarAnagrama() {
Â  Â  Â  Â  const selectedWord = estadoJogo.selecaoN2.map(item => item.letter).join('');
Â  Â  Â  Â  const targetWord = estadoJogo.palavraAtualN2.toLowerCase();

Â  Â  Â  Â  if (selectedWord === targetWord) {
Â  Â  Â  Â  Â  Â  estadoJogo.progressoNivel2++;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (estadoJogo.progressoNivel2 >= MAX_N2_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  Â  Â  // SUCCESS: Go home
Â  Â  Â  Â  Â  Â  Â  Â  onGameSuccess(() => mostrarTela('home'));
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // PARTIAL SUCCESS: Just advance
Â  Â  Â  Â  Â  Â  Â  Â  iniciarNivel2();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.selecaoN2.forEach(item => item.element.classList.remove('invisivel'));
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.selecaoN2 = [];
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('selecao-atual').textContent = ''; // Reset display
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('btn-cancelar-anagrama').disabled = true;
Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  }
Â  Â  Â  Â  salvarEstado();
Â  Â  Â  Â  atualizarInterfaceHome();Â 
Â  Â  }


Â  Â  // --- NÃVEL 3: SÃLABAS ---
Â  Â Â 
Â  Â  function generateDistractorsSilabas(correct) {
Â  Â  Â  Â  const correctLower = correct.toLowerCase();
Â  Â  Â  Â  let distractors = [];
Â  Â  Â  Â  const alphabet = 'bcdefghijklmnpqrstvwxyz';

Â  Â  Â  Â  for (let i = 0; i < correctLower.length; i++) {
Â  Â  Â  Â  Â  Â  const originalChar = correctLower[i];
Â  Â  Â  Â  Â  Â  const randomChar = alphabet[Math.floor(Math.random() * alphabet.length)];

Â  Â  Â  Â  Â  Â  if (!'aeiouÃ£Ãµ'.includes(originalChar) && randomChar !== originalChar) {
Â  Â  Â  Â  Â  Â  Â  Â  const distractor = correctLower.substring(0, i) + randomChar + correctLower.substring(i + 1);
Â  Â  Â  Â  Â  Â  Â  Â  if (distractor !== correctLower && !distractors.includes(distractor) && distractors.length < 2) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  distractors.push(distractor);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  while (distractors.length < 2) {
Â  Â  Â  Â  Â  Â  let uniqueDistractor = correctLower.substring(0, correctLower.length - 1) + alphabet[Math.floor(Math.random() * alphabet.length)] + (correctLower.length > 2 ? 'a' : '');
Â  Â  Â  Â  Â  Â  if (!distractors.includes(uniqueDistractor) && uniqueDistractor.length >= 2) {
Â  Â  Â  Â  Â  Â  Â  Â  Â distractors.push(uniqueDistractor);
Â  Â  Â  Â  Â  Â  } else if (distractors.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  distractors.push('tepo');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  return distractors.slice(0, 2);
Â  Â  }

Â  Â  let silabaAtual = '';

Â  Â  function iniciarNivel3() {
Â  Â  Â  Â  if (estadoJogo.progressoNivel3 >= MAX_N3_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Pool of words for Level 3 (Indices 11-30)
Â  Â  Â  Â  const PALAVRAS_PARA_N3 = PALAVRAS.slice(10, 30);Â 
Â  Â  Â  Â  if (PALAVRAS_PARA_N3.length === 0) {
Â  Â  Â  Â  Â  Â  console.error("NÃ­vel 3: Palavras do Ã­ndice 11 ao 30 nÃ£o encontradas.");
Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- STEP 1: Determine the target syllable (must be one that hasn't been completed yet) ---
Â  Â  Â  Â Â 
Â  Â  Â  Â  let silabasNaoCompletas = SILABAS_ALVO.filter(s => (estadoJogo.syllabesCompletasPorPalavra[s] || 0) < 1);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // If all 29 unique syllables are solved, loop the list for the remaining challenges (up to 20 total)
Â  Â  Â  Â  const silabasSource = silabasNaoCompletas.length > 0 ? silabasNaoCompletas : SILABAS_ALVO;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // LOGIC FIX: Prevent consecutive repetition of the *syllable*
Â  Â  Â  Â  let silabasCandidatas = [...silabasSource];
Â  Â  Â  Â  if (silabasCandidatas.length > 1 && silabaAnteriorN3) {
Â  Â  Â  Â  Â  Â  Â silabasCandidatas = silabasCandidatas.filter(s => s !== silabaAnteriorN3);
Â  Â  Â  Â  Â  Â  Â if (silabasCandidatas.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â silabasCandidatas = silabasSource; // Fallback
Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  silabaAtual = silabasCandidatas[Math.floor(Math.random() * silabasCandidatas.length)];
Â  Â  Â  Â  silabaAnteriorN3 = silabaAtual;Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Note: For Level 3, the target word is no longer relevant for the challenge, only the syllable.

Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('silaba-maiuscula').textContent = silabaAtual.toUpperCase();

Â  Â  Â  Â  const optionsDiv = document.getElementById('opcoes-silabas');
Â  Â  Â  Â  optionsDiv.innerHTML = '';

Â  Â  Â  Â  const options = [silabaAtual, ...generateDistractorsSilabas(silabaAtual)];
Â  Â  Â  Â  options.sort(() => Math.random() - 0.5);

Â  Â  Â  Â  options.forEach(opt => {
Â  Â  Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  Â  Â  btn.className = 'opcao-btn';
Â  Â  Â  Â  Â  Â  btn.textContent = opt;
Â  Â  Â  Â  Â  Â  btn.onclick = () => verificarSilaba(opt);
Â  Â  Â  Â  Â  Â  optionsDiv.appendChild(btn);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function verificarSilaba(selection) {
Â  Â  Â  Â  if (selection === silabaAtual) {
Â  Â  Â  Â  Â  Â  const syllableKey = silabaAtual;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // 1. Check if this specific syllable has been solved once
Â  Â  Â  Â  Â  Â  if ((estadoJogo.syllabesCompletasPorPalavra[syllableKey] || 0) === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.syllabesCompletasPorPalavra[syllableKey] = 1;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // 2. Count toward the MAX_N3_COMPLETIONS goal (20 points total)
Â  Â  Â  Â  Â  Â  if (estadoJogo.progressoNivel3 < MAX_N3_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoNivel3++;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (estadoJogo.progressoNivel3 === MAX_N3_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  Â  Â  // LEVEL COMPLETION: Go home
Â  Â  Â  Â  Â  Â  Â  Â  onGameSuccess(() => mostrarTela('home'));
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // PARTIAL SUCCESS: Just advance
Â  Â  Â  Â  Â  Â  iniciarNivel3();

Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // FAILURE: Just advance
Â  Â  Â  Â  Â  Â  iniciarNivel3();
Â  Â  Â  Â  }
Â  Â  Â  Â  salvarEstado();
Â  Â  Â  Â  atualizarInterfaceHome();Â 
Â  Â  }

Â  Â  // --- NÃVEL 4: IDENTIFICAÃ‡ÃƒO DE PALAVRAS ---
Â  Â Â 
Â  Â  function iniciarNivel4() {
Â  Â  Â  Â  if (estadoJogo.progressoN4 >= MAX_N4_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Filter words to indices 31 through 50 (20 words total)
Â  Â  Â  Â  const PALAVRAS_PARA_N4 = PALAVRAS.slice(30, 50);Â 
Â  Â  Â  Â  if (PALAVRAS_PARA_N4.length === 0) {
Â  Â  Â  Â  Â  Â  console.error("NÃ­vel 4: Palavras do Ã­ndice 31 ao 50 nÃ£o encontradas.");
Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Filter words that have NOT been completed once yet
Â  Â  Â  Â  const palavrasDisponiveisN4 = PALAVRAS_PARA_N4.filter(p => {
Â  Â  Â  Â  Â  Â  Â return (estadoJogo.palavrasCompletasN4[p.toLowerCase()] || 0) < 1;
Â  Â  Â  Â  });

Â  Â  Â  Â  const palavrasCandidatasSource = palavrasDisponiveisN4.length > 0 ? palavrasDisponiveisN4 : PALAVRAS_PARA_N4;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const targetWord = palavrasCandidatasSource[Math.floor(Math.random() * palavrasCandidatasSource.length)];
Â  Â  Â  Â  palavraAtual = targetWord; // Set global word for scoring

Â  Â  Â  Â  // 1. Set the target word in UPPERCASE
Â  Â  Â  Â  document.getElementById('identificacao-alvo').textContent = targetWord.toUpperCase();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 2. Generate options (1 correct, 2 distractors)
Â  Â  Â  Â  // Distractors are drawn from the full PALAVRAS list for variety
Â  Â  Â  Â  const distractors = generateSimilarWords(targetWord, PALAVRAS);
Â  Â  Â  Â  let options = [targetWord, ...distractors];
Â  Â  Â  Â  options = shuffleArray(options);

Â  Â  Â  Â  const optionsDiv = document.getElementById('opcoes-identificacao');
Â  Â  Â  Â  optionsDiv.innerHTML = '';

Â  Â  Â  Â  options.forEach(opt => {
Â  Â  Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  Â  Â  btn.className = 'opcao-btn';
Â  Â  Â  Â  Â  Â  btn.textContent = opt.toLowerCase(); // Options in lowercase
Â  Â  Â  Â  Â  Â  btn.onclick = () => verificarPalavraVisual(opt);
Â  Â  Â  Â  Â  Â  optionsDiv.appendChild(btn);
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  salvarEstado();
Â  Â  }

Â  Â  function verificarPalavraVisual(selection) {
Â  Â  Â  Â  if (selection.toLowerCase() === palavraAtual.toLowerCase()) {
Â  Â  Â  Â  Â  Â  const key = palavraAtual.toLowerCase();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if ((estadoJogo.palavrasCompletasN4[key] || 0) === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.palavrasCompletasN4[key] = 1;

Â  Â  Â  Â  Â  Â  Â  Â  if (estadoJogo.progressoN4 < MAX_N4_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoN4++;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (estadoJogo.progressoN4 === MAX_N4_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  Â  Â  // SUCCESS: Go home
Â  Â  Â  Â  Â  Â  Â  Â  onGameSuccess(() => mostrarTela('home'));
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // PARTIAL SUCCESS: Just advance
Â  Â  Â  Â  Â  Â  iniciarNivel4();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // FAILURE: Just advance
Â  Â  Â  Â  Â  Â  iniciarNivel4();
Â  Â  Â  Â  }
Â  Â  Â  Â  salvarEstado();
Â  Â  Â  Â  atualizarInterfaceHome();Â 
Â  Â  }


Â  Â  // --- NÃVEL 5: PALAVRAS (ÃUDIO) ---

Â  Â  function iniciarNivel5() {
Â  Â  Â  Â  if (estadoJogo.progressoN5 >= MAX_N5_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Filter words to indices 51 through 60 (10 words total)
Â  Â  Â  Â  const PALAVRAS_PARA_N5 = PALAVRAS.slice(50, 60);Â 
Â  Â  Â  Â  if (PALAVRAS_PARA_N5.length === 0) {
Â  Â  Â  Â  Â  Â  console.error("NÃ­vel 5: Palavras do Ã­ndice 51 ao 60 nÃ£o encontradas.");
Â  Â  Â  Â  Â  Â  mostrarTela('home');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Filter words that have NOT been completed once yet
Â  Â  Â  Â  const palavrasDisponiveisN5 = PALAVRAS_PARA_N5.filter(p => {
Â  Â  Â  Â  Â  Â  Â return (estadoJogo.palavrasCompletasN5[p.toLowerCase()] || 0) < 1;
Â  Â  Â  Â  });

Â  Â  Â  Â  const palavrasCandidatasSource = palavrasDisponiveisN5.length > 0 ? palavrasDisponiveisN5 : PALAVRAS_PARA_N5;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const distractorsSource = PALAVRAS;

Â  Â  Â  Â  // LOGIC FIX: Prevent consecutive repetition
Â  Â  Â  Â  let palavrasCandidatas = [...palavrasCandidatasSource];
Â  Â  Â  Â  if (palavrasCandidatas.length > 1 && palavraAnteriorN5) {
Â  Â  Â  Â  Â  Â  Â palavrasCandidatas = palavrasCandidatas.filter(p => p.toLowerCase() !== palavraAnteriorN5);
Â  Â  Â  Â  Â  Â  Â if (palavrasCandidatas.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â palavrasCandidatas = palavrasCandidatasSource;
Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  }

Â  Â  Â  Â  palavraAtual = palavrasCandidatas[Math.floor(Math.random() * palavrasCandidatas.length)];
Â  Â  Â  Â  palavraAnteriorN5 = palavraAtual.toLowerCase();
Â  Â  Â  Â Â 
Â  Â  Â  Â  const distractors = generateSimilarWords(palavraAtual, distractorsSource);
Â  Â  Â  Â  let options = [palavraAtual, ...distractors];
Â  Â  Â  Â  options = shuffleArray(options);Â 

Â  Â  Â  Â  const optionsDiv = document.getElementById('opcoes-palavras');
Â  Â  Â  Â  optionsDiv.innerHTML = '';

Â  Â  Â  Â  options.forEach(opt => {
Â  Â  Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  Â  Â  btn.className = 'opcao-btn';
Â  Â  Â  Â  Â  Â  btn.textContent = opt.charAt(0).toUpperCase() + opt.slice(1).toLowerCase();
Â  Â  Â  Â  Â  Â  btn.onclick = () => verificarPalavraAudio(opt);
Â  Â  Â  Â  Â  Â  optionsDiv.appendChild(btn);
Â  Â  Â  Â  });

Â  Â  Â  Â  setTimeout(falarPalavraAtual, 500);
Â  Â  }

Â  Â  function falarPalavraAtual() {
Â  Â  Â  Â  if (palavraAtual) {
Â  Â  Â  Â  Â  Â  falarTexto(palavraAtual);
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function verificarPalavraAudio(selection) {
Â  Â  Â  Â  if (selection.toLowerCase() === palavraAtual.toLowerCase()) {
Â  Â  Â  Â  Â  Â  const key = palavraAtual.toLowerCase();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if ((estadoJogo.palavrasCompletasN5[key] || 0) === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.palavrasCompletasN5[key] = 1;

Â  Â  Â  Â  Â  Â  Â  Â  if (estadoJogo.progressoN5 < MAX_N5_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  estadoJogo.progressoN5++;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (estadoJogo.progressoN5 === MAX_N5_COMPLETIONS) {
Â  Â  Â  Â  Â  Â  Â  Â  // SUCCESS: Go home
Â  Â  Â  Â  Â  Â  Â  Â  onGameSuccess(() => mostrarTela('home'));
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // PARTIAL SUCCESS: Just advance
Â  Â  Â  Â  Â  Â  iniciarNivel5();

Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // FAILURE: Just advance
Â  Â  Â  Â  Â  Â  iniciarNivel5();
Â  Â  Â  Â  }
Â  Â  Â  Â  salvarEstado();
Â  Â  Â  Â  atualizarInterfaceHome();Â 
Â  Â  }


Â  Â  async function inicializarJogo() {
Â  Â  Â  Â  carregarEstado();
Â  Â  Â  Â  atualizarInterfaceHome();
Â  Â  }

Â  Â  // --- INITIALISATION ---
Â  Â  document.addEventListener('DOMContentLoaded', inicializarJogo);
</script>


<div id="browser-voice-control"></div></body>
</html>
